<!DOCTYPE html>
<html>
  <head>
    <title>Letter Frequencies in Names of Virginia&nbsp;Cities | Disaster Area</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="http://paxswill.com/theme/favicon.ico">
    <link rel="alternate" type="application/atom+xml" title="Disaster Area" href="http://paxswill.com/atom.xml">
    <link rel="alternate" type="application/rss+xml" title="Disaster Area" href="http://paxswill.com/rss.xml">
    <!-- Stylesheets -->
    <link rel="stylesheet" media="screen" href="http://paxswill.com/theme/css/bootstrap.css">
    <link rel="stylesheet" href="http://paxswill.com/theme/font-awesome/css/font-awesome.css">
    <link rel="stylesheet" href="http://paxswill.com/theme/css/style.css">
    <link rel="stylesheet" href="http://paxswill.com/theme/css/pygments.css">
  </head>
  <body>
    <div class="container">
      <div class="row">
        <header class="col-sm-offset-2 col-sm-8 col-md-offset-1 col-md-2">
          <h1><a href="http://paxswill.com/">Disaster Area</a><br class="visible-md visible-lg">
              <small>
                  <a href="mailto:paxswill@paxswill.com">
                    <i class="icon-envelope"></i>
                  </a>
                  <a href="https://github.com/paxswill">
                    <i class="icon-github-sign"></i>
                  </a>
                      <a href="http://paxswill.com/atom.xml">
                        <i class="icon-rss-sign"></i>
                      </a>
            </small>
          </h1>
        </header>
        <div class="clearfix hidden-md hidden-lg"></div>
        <div class="col-sm-2 hidden-md hidden-lg"></div>
        <div class="col-sm-8 col-md-6">
<article>
<h2>
  <a href="/blog/2013/02/28/virginia-cities/">Letter Frequencies in Names of Virginia&nbsp;Cities</a>
<small><time datetime="2013-02-28 00:00" pubdate>
  28 February 2013
</time>
</small></h2>


<div class="text_cell_render border-box-sizing rendered_html">
<p>Recently I&#8217;ve noticed on Facebook a couple of trivia posts asking you to try to name a city in Virgina with a certain letter in it. As background, thses posts are coming from my friends living in Virginia. You also have to be at least somewhat familiar with <a href="https://en.wikipedia.org/wiki/Political_subdivisions_of_Virginia">Virginian municipal structure</a>. Like other states, Virginia is divided up into counties. In most other states, the next step down is cities and/or towns. In Virginia, cities are independant and on the same level as counties. So the bar for being a city is pretty high, and many people can name a decent number of them if they put their mind to it. I wanted to find out if there were any letters not used in any cities. And because (like many programmers) I&#8217;m lazy and didn&#8217;t want to look through all of the cities manually I turned to Python to help&nbsp;me.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Start with some basic setup. <code>Counter</code> is a counted set. <code>pprint</code> provides a nicer way to print lists and other containers by adding line breaks and such. <a href="http://www.crummy.com/software/BeautifulSoup/">BeautifulSoup</a> is a really easy to use <span class="caps">HTML</span> parser+navigator. <a href="http://docs.python-requests.org/en/latest/">Requests</a> makes it easy to download things from the&nbsp;web.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">


<div class="input_area box-flex1">
<div class="highlight"><pre><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>
<span class="kn">import</span> <span class="nn">string</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">PrettyPrinter</span>

<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="c"># A prettier way to print</span>
<span class="n">pprint</span> <span class="o">=</span> <span class="n">PrettyPrinter</span><span class="p">()</span><span class="o">.</span><span class="n">pprint</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Wikipedia provides a nice <a href="http://en.wikipedia.org/wiki/Cities_in_virginia">list</a> of the cities in Virginia. I find all the tables (<code>&lt;table&gt;</code> elements) on the page, and the second one is the one I want. I then get a list of the text of all links (<code>&lt;a&gt;</code> elements) in that&nbsp;table.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">


<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">city_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;http://en.wikipedia.org/wiki/Cities_in_virginia&#39;</span><span class="p">)</span>
<span class="n">city_soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">city_response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

<span class="n">tables</span> <span class="o">=</span> <span class="n">city_soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">&#39;table&#39;</span><span class="p">)</span>
<span class="c"># Python starts counting at 0 like many other programming languages</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">tables</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="c"># There are some blank links, so drop those</span>
<span class="n">cities</span> <span class="o">=</span> <span class="p">[</span><span class="n">link</span><span class="o">.</span><span class="n">string</span> <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">&#39;a&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">link</span><span class="o">.</span><span class="n">string</span><span class="p">]</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now run through the list of cities, and add each one to a <code>Counter</code>. Then I print out how many cities there are and a list of the letters used, sorted by how often they were&nbsp;used.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">


<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">city_count</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>
<span class="k">for</span> <span class="n">city</span> <span class="ow">in</span> <span class="n">cities</span><span class="p">:</span>
    <span class="c"># Add each letter of the lowercase city name to the Counter</span>
    <span class="n">city_count</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">city</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;{} cities&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cities</span><span class="p">)))</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">city_count</span><span class="o">.</span><span class="n">most_common</span><span class="p">())</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
39 cities
[(&apos;a&apos;, 35),
 (&apos;r&apos;, 31),
 (&apos;o&apos;, 30),
 (&apos;n&apos;, 29),
 (&apos;e&apos;, 27),
 (&apos;s&apos;, 25),
 (&apos;l&apos;, 24),
 (&apos;i&apos;, 23),
 (&apos;t&apos;, 17),
 (&apos;h&apos;, 14),
 (&apos;u&apos;, 11),
 (&apos;c&apos;, 11),
 (&apos;b&apos;, 10),
 (&apos;f&apos;, 10),
 (&apos;g&apos;, 10),
 (&apos;p&apos;, 9),
 (&apos;m&apos;, 9),
 (&apos;d&apos;, 8),
 (&apos;k&apos;, 7),
 (&apos;v&apos;, 6),
 (&apos;w&apos;, 6),
 (&apos; &apos;, 6),
 (&apos;x&apos;, 4),
 (&apos;y&apos;, 2),
 (&apos;q&apos;, 1)]

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>I guess space (&#8216; &#8216;) counts as a letter, for those cities that are two words. Now I want to see which letters aren&#8217;t used . To do this I make a set of the letters that were found and subtract it from a set of all lowercase&nbsp;characters.</p>
<p>Sidenote: Confused from earlier where I said that <code>Counter</code> was a counted set? Well, it is but it isn&#8217;t a <em>set</em> so the set operators won&#8217;t work on&nbsp;it.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">


<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">not_in_cities</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">city_count</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">not_in_cities</span><span class="p">)</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
{&apos;z&apos;, &apos;j&apos;}

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Bet you can&#8217;t name a city that contains the letter&nbsp;&#8216;J&#8217;!</p>
<p>And because they&#8217;re pretty big, let&#8217;s look at incorporated towns. Again, Wikipedia has a <a href="http://en.wikipedia.org/wiki/List_of_towns_in_Virginia">list</a> of them that I&#8217;ll use. This list isn&#8217;t in a table, so it&#8217;s a bit harder to pull&nbsp;out.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">


<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">town_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;http://en.wikipedia.org/wiki/List_of_towns_in_Virginia&#39;</span><span class="p">)</span>
<span class="n">town_soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">town_response</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</pre></div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>First I grab the main content area. Wikipedia displays the actual town names as elements (<code>&lt;li&gt;</code> elements) within unordered lists (<code>&lt;ul&gt;</code> elements), one for each letter in the alphabet. Because there are some other unordered lists in the content, I find all unordered lists that are only one level down (this is starting to get into the specifics of <span class="caps">HTML</span>, but it&#8217;ll be over soon). Then I go through each list, and save the link text for the first link I find in each list item. After than, the process is the same as the&nbsp;cities.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">


<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">town_content</span> <span class="o">=</span> <span class="n">town_soup</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;div&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="s">&#39;mw-content-text&#39;</span><span class="p">)</span>
<span class="n">lists</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">town_content</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">&#39;ul&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">element</span><span class="o">.</span><span class="n">parent</span> <span class="o">==</span> <span class="n">town_content</span><span class="p">]</span>
<span class="n">towns</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">ul</span> <span class="ow">in</span> <span class="n">lists</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">ul</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s">&#39;li&#39;</span><span class="p">):</span>
        <span class="n">town_link</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">a</span>
        <span class="c"># The references list has rel=&quot;nofollow&quot;, and we don&#39;t want the references</span>
        <span class="k">if</span> <span class="s">&#39;rel&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">town_link</span><span class="o">.</span><span class="n">attrs</span><span class="p">:</span>
            <span class="n">towns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">town_link</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>

<span class="k">for</span> <span class="n">town</span> <span class="ow">in</span> <span class="n">towns</span><span class="p">:</span>
    <span class="n">town_count</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">town</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span>

<span class="k">print</span><span class="p">(</span><span class="s">&quot;{} towns&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">towns</span><span class="p">)))</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">town_count</span><span class="o">.</span><span class="n">most_common</span><span class="p">())</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
190 towns
[(&apos;e&apos;, 310),
 (&apos;a&apos;, 278),
 (&apos;l&apos;, 272),
 (&apos;n&apos;, 258),
 (&apos;o&apos;, 248),
 (&apos;r&apos;, 232),
 (&apos;i&apos;, 216),
 (&apos;t&apos;, 200),
 (&apos;s&apos;, 174),
 (&apos;c&apos;, 154),
 (&apos;h&apos;, 102),
 (&apos;d&apos;, 100),
 (&apos;u&apos;, 94),
 (&apos;b&apos;, 88),
 (&apos; &apos;, 82),
 (&apos;g&apos;, 82),
 (&apos;m&apos;, 70),
 (&apos;p&apos;, 66),
 (&apos;w&apos;, 66),
 (&apos;v&apos;, 64),
 (&apos;y&apos;, 64),
 (&apos;k&apos;, 60),
 (&apos;f&apos;, 38),
 (&apos;x&apos;, 16),
 (&apos;j&apos;, 6),
 (&apos;.&apos;, 4),
 (&apos;q&apos;, 4),
 (&apos;z&apos;, 2)]

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">


<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">not_in_towns</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">string</span><span class="o">.</span><span class="n">ascii_lowercase</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">town_count</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">not_in_towns</span><span class="p">)</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
set()

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>set()</code> means that every letter is used (the &#8216;.&#8217;s are from St. Charles and St. Paul). Now I want to see what the counts are for the cities and towns combined. I create a new <code>Counter</code> from the cities` and then add the&nbsp;towns&#8217;.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox">


<div class="input_area box-flex1">
<div class="highlight"><pre><span class="n">city_town_count</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="n">city_count</span><span class="p">)</span>
<span class="n">city_town_count</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">town_count</span><span class="p">)</span>
<span class="n">pprint</span><span class="p">(</span><span class="n">city_town_count</span><span class="o">.</span><span class="n">most_common</span><span class="p">())</span>
</pre></div>

</div>
</div>

<div class="vbox output_wrapper">
<div class="output vbox">


<div class="hbox output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre>
[(&apos;e&apos;, 337),
 (&apos;a&apos;, 313),
 (&apos;l&apos;, 296),
 (&apos;n&apos;, 287),
 (&apos;o&apos;, 278),
 (&apos;r&apos;, 263),
 (&apos;i&apos;, 239),
 (&apos;t&apos;, 217),
 (&apos;s&apos;, 199),
 (&apos;c&apos;, 165),
 (&apos;h&apos;, 116),
 (&apos;d&apos;, 108),
 (&apos;u&apos;, 105),
 (&apos;b&apos;, 98),
 (&apos;g&apos;, 92),
 (&apos; &apos;, 88),
 (&apos;m&apos;, 79),
 (&apos;p&apos;, 75),
 (&apos;w&apos;, 72),
 (&apos;v&apos;, 70),
 (&apos;k&apos;, 67),
 (&apos;y&apos;, 66),
 (&apos;f&apos;, 48),
 (&apos;x&apos;, 20),
 (&apos;j&apos;, 6),
 (&apos;q&apos;, 5),
 (&apos;.&apos;, 4),
 (&apos;z&apos;, 2)]

</pre>
</div>
</div>

</div>
</div>

</div>
</article>

        </div>
      </div>
    </div>
    <footer>
      <div class="container">
        <div class="row">
          <div class="col-md-offset-3 col-md-3">
            <ul>
                <li><a href="/tutorials">Tutorials</a></li>
                <li><a href="/archives">Archives</a></li>
            </ul>
          </div>
          <div class="col-md-3">
            <p>&copy; Will Ross 2008&ndash;2013
</p>
          </div>
        </div>
      </div>
    </footer>
    <script src="//code.jquery.com/jquery.js"></script>
    <script src="theme/js/bootstrap.min.js"></script>
  </body>
</html>